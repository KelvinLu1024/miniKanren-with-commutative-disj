
\begin{ZZZZschemedisplay}%
(\sy{define} (\va{elim} s$^\infty$ $k_s$ $k_f$)\\%
\PRN \HL \=(\sy{let} \=(\=[\va{ss} (\va{car} s$^\infty$)]\\%
  \>     \> \>[\va{f} (\va{cdr} s$^\infty$)])\\%
  \>\HL \HL \=(\sy{cond}\\%
  \>  \>\PRN \HL \=[\=(\sy{and} (\va{null?} \va{ss}) \va{f})\\%
  \>  \>  \> \>(\va{step} (\sy{lambda} () (\va{elim} (\va{f}) $k_s$ $k_f$)))]\\%
  \>  \>  \>[(\va{null?} \va{ss}) ($k_f$)]\\%
  \>  \>  \>[\sy{else} ($k_s$ (\va{car} \va{ss}) (\va{cons} (\va{cdr} \va{ss}) \va{f}))])))
\end{ZZZZschemedisplay}

\begin{ZZZZschemedisplay}%
(\sy{define} (\va{ifte} $g_1$ $g_2$ $g_3$)\\%
\PRN \HL \=(\sy{lambda} (\va{s})\\%
  \>\PRN \HL \=(\va{elim} ($g_1$ \va{s})\\%
  \>  \>\PRN \HL \=(\sy{lambda} (\va{s0} s$^\infty$)\\%
  \>  \>  \>\PRN \HL \=(append-map$^\infty_f$ $g_2$\\%
  \>  \>  \>  \>\PRN \HL (append$^\infty_f$ (\va{unit} \va{s0}) s$^\infty$)))\\%
  \>  \>  \>(\sy{lambda} () ($g_3$ \va{s})))))
\end{ZZZZschemedisplay}

\begin{ZZZZschemedisplay}%
(\sy{define} (\va{once} \va{g})\\%
\PRN \HL \=(\sy{lambda} (\va{s})\\%
  \>\PRN \HL \=(\va{elim} (\va{g} \va{s})\\%
  \>  \>\PRN \HL \=(\sy{lambda} (\va{s0} s$^\infty$) (\va{unit} \va{s0}))\\%
  \>  \>  \>(\sy{lambda} () (\va{none})))))%
\end{ZZZZschemedisplay}
