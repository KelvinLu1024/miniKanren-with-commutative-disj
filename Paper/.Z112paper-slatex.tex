\begin{ZZZZschemedisplay}%
(\sy{define} (\va{none}) \ \ `(() \ \ . \cn{\#f}))\\%
(\sy{define} (\va{unit} \va{s}) `((,\va{s}) . \cn{\#f}))\\%
(\sy{define} (\va{step} \va{f}) `(() \ \ . ,\va{f}))
\end{ZZZZschemedisplay}

\begin{ZZZZschemedisplay}%
(\sy{define} (append$^\infty_f$ s$^\infty$ t$^\infty$)\\%
\PRN \HL \=(\va{cons} (\va{append} (\va{car} s$^\infty$) (\va{car} t$^\infty$))\\%
  \>\PRN \HL \=(\sy{let} \=(\=[\va{t1} (\va{cdr} s$^\infty$)]\\%
  \>  \>     \> \>[\va{t2} (\va{cdr} t$^\infty$)])\\%
  \>  \>\HL \HL \=(\sy{cond}\\%
  \>  \>  \>\PRN \HL \=[(\va{not} \va{t1}) \va{t2}]\\%
  \>  \>  \>  \>[(\va{not} \va{t2}) \va{t1}]\\%
  \>  \>  \>  \>[\sy{else} (\sy{lambda} () (append$^\infty_f$ (\va{t1}) (\va{t2})))]))))
\end{ZZZZschemedisplay}

\begin{ZZZZschemedisplay}%
(\sy{define} (append-map$^\infty_f$ \va{g} s$^\infty$)\\%
\PRN \HL \=(\va{foldr}\\%
  \>\PRN \HL \=(\sy{lambda} (\va{s} t$^\infty$)\\%
  \>  \>\PRN \HL (append$^\infty_f$ (\va{g} \va{s}) t$^\infty$))\\%
  \>  \>(\sy{let} ([\va{f} (\va{cdr} s$^\infty$)])\\%
  \>  \>\PRN \HL (\va{step} (\sy{and} \va{f} (\sy{lambda} () (append-map$^\infty_f$ \va{g} (\va{f}))))))\\%
  \>  \>(\va{car} s$^\infty$)))
\end{ZZZZschemedisplay}

\begin{ZZZZschemedisplay}%
(\sy{define} (\va{take-inf} \va{n} s$^\infty$)\\%
\PRN \HL \=(\sy{let} \va{loop} \=(\=[\va{n} \va{n}]\\%
  \>          \> \>[\va{vs} (\va{car} s$^\infty$)])\\%
  \>\HL \HL \=(\sy{cond}\\%
  \>  \>\PRN \HL \=((\sy{and} \va{n} (\va{zero?} \va{n})) '())\\%
  \>  \>  \>((\va{pair?} \va{vs})\\%
  \>  \>  \>\PRN \=(\va{cons} (\va{car} \va{vs})\\%
  \>  \>  \> \>\PRN \HL (\va{loop} (\sy{and} \va{n} (\va{sub1} \va{n})) (\va{cdr} \va{vs}))))\\%
  \>  \>  \>(\sy{else}\\%
  \>  \>  \>\PRN \=(\sy{let} ([\va{f} (\va{cdr} s$^\infty$)])\\%
  \>  \>  \> \>\PRN \HL (\sy{if} \va{f} (\va{take-inf} \va{n} (\va{f})) '()))))))%
\end{ZZZZschemedisplay}
